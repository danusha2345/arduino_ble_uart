# –†–µ–∑—é–º–µ –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ ESP-IDF v6

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ ESP-IDF v6

```
esp-idf-v6/
‚îú‚îÄ‚îÄ main/                   # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ main.c             # ‚úÖ UART + –±—É—Ñ–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ config.h           # ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è C3/C6/S3
‚îÇ   ‚îú‚îÄ‚îÄ ble_service.c      # üöß –ó–∞–≥–ª—É—à–∫–∞ (TODO)
‚îÇ   ‚îú‚îÄ‚îÄ wifi_service.c     # üöß –ó–∞–≥–ª—É—à–∫–∞ (TODO)
‚îÇ   ‚îú‚îÄ‚îÄ gps_parser.c       # üöß –ó–∞–≥–ª—É—à–∫–∞ (TODO)
‚îÇ   ‚îú‚îÄ‚îÄ display_manager.c  # üöß –ó–∞–≥–ª—É—à–∫–∞ (TODO)
‚îÇ   ‚îú‚îÄ‚îÄ CMakeLists.txt     # ‚úÖ –°–±–æ—Ä–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ Kconfig.projbuild  # ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∏–Ω–æ–≤
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ lv_conf.h          # ‚úÖ LVGL 9.4.0 –∫–æ–Ω—Ñ–∏–≥
‚îÇ   ‚îî‚îÄ‚îÄ lvgl/              # –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å v9.4.0
‚îú‚îÄ‚îÄ sdkconfig.defaults.*   # ‚úÖ –î–ª—è C3/C6/S3
‚îî‚îÄ‚îÄ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (9 —Ñ–∞–π–ª–æ–≤)
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ESP32-C6 Tenstar SuperMini

**–ü–∏–Ω—ã (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è):**
- UART: RX=6, TX=7 –¥–ª—è GPS
- SPI: MOSI=18, SCLK=19
- TFT: DC=20, RST=21, BL=22
- LED: GPIO8 (WS2812), GPIO15 (–æ–±—ã—á–Ω—ã–π)

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- Flash: 4MB
- LVGL: v9.4.0 (—Å—Ç—Ä–æ–≥–æ)
- –î–∏—Å–ø–ª–µ–π: —Ç–æ–ª—å–∫–æ TFT ST7789V 240x280
- SPI Host: SPI3_HOST

### 3. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –∫–æ–¥–µ

#### Ring Buffer (–ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π)
```c
ring_buffer_t *g_ble_tx_buffer;  // 16KB –¥–ª—è GPS -> BLE/WiFi
ring_buffer_t *g_ble_rx_buffer;  // 4KB –¥–ª—è –∫–æ–º–∞–Ω–¥
```

#### UART (460800 baud)
```c
esp_err_t init_uart(void);      // ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
void uart_task(void *params);   // ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
```

#### –£—Å–ª–æ–≤–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è
```c
#if CONFIG_TARGET_ESP32_C3
    // C3 —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥
#elif CONFIG_TARGET_ESP32_C6
    // C6 —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥ (TFT —Ç–æ–ª—å–∫–æ)
#elif CONFIG_TARGET_ESP32_S3
    // S3 —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥ (dual-core)
#endif
```

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| README.md | –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è |
| QUICK_START.md | –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å `idf6` |
| CHANGELOG.md | –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| MIGRATION_NOTES.md | –ü—Ä–æ–±–ª–µ–º—ã Arduino –∫–æ–¥–∞ |
| INTEGRATION_GUIDE.md | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è LVGL v9.4.0 |
| OVERVIEW.md | –ü–æ–ª–Ω—ã–π –æ–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ |
| SUMMARY.md | –≠—Ç–æ—Ç —Ñ–∞–π–ª |

## üöß TODO (—á—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å)

### –ö—Ä–∏—Ç–∏—á–Ω–æ (–¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞)

1. **BLE —Å–µ—Ä–≤–∏—Å** (`ble_service.c`)
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è NimBLE
   - Nordic UART Service (NUS)
   - TX characteristic (notify)
   - RX characteristic (write)
   - –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ TX –±—É—Ñ–µ—Ä–∞

2. **WiFi —Å–µ—Ä–≤–µ—Ä** (`wifi_service.c`)
   - WiFi AP –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
   - TCP —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 23
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ 4 –∫–ª–∏–µ–Ω—Ç–æ–≤
   - –û—Ç–ø—Ä–∞–≤–∫–∞/–ø—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö

3. **NMEA –ø–∞—Ä—Å–µ—Ä** (`gps_parser.c`)
   - –ü–∞—Ä—Å–∏–Ω–≥ GNS (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –≤—ã—Å–æ—Ç–∞)
   - –ü–∞—Ä—Å–∏–Ω–≥ GST (—Ç–æ—á–Ω–æ—Å—Ç—å)
   - –ü–∞—Ä—Å–∏–Ω–≥ GSA (–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–ø—É—Ç–Ω–∏–∫–∏)
   - –ü–∞—Ä—Å–∏–Ω–≥ GSV (–≤–∏–¥–∏–º—ã–µ —Å–ø—É—Ç–Ω–∏–∫–∏)
   - –ü–∞—Ä—Å–∏–Ω–≥ GGA (RTK —Å—Ç–∞—Ç—É—Å)

### –í–∞–∂–Ω–æ (–¥–ª—è UI)

4. **LVGL UI** (`display_manager.c`)
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è esp_lcd –¥–ª—è ST7789V
   - –°–æ–∑–¥–∞–Ω–∏–µ LVGL –æ–±—ä–µ–∫—Ç–æ–≤
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ GPS –¥–∞–Ω–Ω—ã—Ö
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üìã –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏–∑ Arduino

1. ‚úÖ –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ `SDA_PIN_C6`, `SCL_PIN_C6` - —É–¥–∞–ª–µ–Ω—ã (C6 –±–µ–∑ OLED)
2. ‚úÖ –ö–æ–Ω—Ñ–ª–∏–∫—Ç TFT_eSPI + esp_lcd - —Ç–æ–ª—å–∫–æ esp_lcd
3. ‚úÖ –°–º–µ—à–∞–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ - –µ–¥–∏–Ω—ã–π LVGL v9.4.0
4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã LED_PIN, LED_PIN_2, LCD_SPI_HOST –¥–ª—è C6

## üöÄ –ö–∞–∫ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å

### –®–∞–≥ 1: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è LVGL

```bash
cd esp-idf-v6
idf6
cd components
git clone --depth 1 --branch v9.4.0 https://github.com/lvgl/lvgl.git
cd ..
```

### –®–∞–≥ 2: –°–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç –±–∞–∑—ã

```bash
idf.py set-target esp32c6
idf.py build
idf.py -p /dev/ttyUSB0 flash monitor
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
I (xxx) MAIN: GNSS BLE/WiFi Bridge - ESP-IDF v6
I (xxx) MAIN: Board: ESP32-C6
I (xxx) MAIN: Initializing UART on RX:6 TX:7
I (xxx) UART: UART task started on core 0
```

### –®–∞–≥ 3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π

–í –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞:
1. BLE —Å–µ—Ä–≤–∏—Å (—Å–º. –ø—Ä–∏–º–µ—Ä—ã NimBLE –≤ ESP-IDF)
2. WiFi —Å–µ—Ä–≤–µ—Ä (—Å–º. –ø—Ä–∏–º–µ—Ä—ã WiFi AP –≤ ESP-IDF)
3. NMEA –ø–∞—Ä—Å–µ—Ä (–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ Arduino –∫–æ–¥–∞)
4. LVGL UI (—Å–º. –ø—Ä–∏–º–µ—Ä—ã esp_lcd –≤ ESP-IDF)

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **–§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ**: 20
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞**: ~1500 (–±–∞–∑–∞)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: 9 —Ñ–∞–π–ª–æ–≤
- **–í—Ä–µ–º—è –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ**: ~3 —á–∞—Å–∞
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å**: ~30% (–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞)

## üéØ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ
2. **–ü–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ C3/C6/S3
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - FreeRTOS –∑–∞–¥–∞—á–∏, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
4. **–ì–∏–±–∫–æ—Å—Ç—å** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ menuconfig
5. **–ß–∏—Å—Ç–æ—Ç–∞** - –Ω–∞—Ç–∏–≤–Ω—ã–π C, –±–µ–∑ Arduino –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π

## üìù –ó–∞–º–µ—Ç–∫–∏

- ESP-IDF v6 –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è: `idf6`
- LVGL —Å—Ç—Ä–æ–≥–æ v9.4.0
- C6 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ TFT, –±–µ–∑ OLED
- Flash: 4MB –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ sdkconfig
- –ë—É—Ñ–µ—Ä—ã: TX=16KB, RX=4KB

---

**–î–∞—Ç–∞**: 2025-11-04
**–°—Ç–∞—Ç—É—Å**: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è BLE —Å–µ—Ä–≤–∏—Å–∞
